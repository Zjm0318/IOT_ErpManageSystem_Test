
@{
    ViewData["Title"] = "Edit";
}

<input type="hidden" value="@ViewBag.id" id="id" />
<input type="hidden" id="lid" />

<div class="layui-form-item">
    <h2>发起信息</h2>
    <div class="layui-inline">
        <label class="layui-form-label"><span style="color:red">*</span>引进负责人</label>
        <div class="layui-input-inline">
            <input type="text" id="Name" required placeholder="请输入引进负责人" class="layui-input" />
        </div>
        <label class="layui-form-label">供应商编号</label>
        <div class="layui-input-inline">
            <input type="text" id="BianHao" placeholder="请输入供应商编号" class="layui-input" />
        </div>
        <label class="layui-form-label"><span style="color:red">*</span>供应商来源</label>
        <div class="layui-input-inline">
            <input type="text" id="LaiYuan" required placeholder="请输入供应商来源" class="layui-input" />
        </div>
    </div>
    <h2>公司信息</h2>
    <div class="layui-inline">
        <label class="layui-form-label"><span style="color:red">*</span>单位名称</label>
        <div class="layui-input-inline">
            <input type="text" id="DanWei" required placeholder="请输入单位名称" class="layui-input" />
        </div>
        <label class="layui-form-label">供方简称</label>
        <div class="layui-input-inline">
            <input type="text" id="JianCheng" placeholder="请输入单位名称" class="layui-input" />
        </div>
        <label class="layui-form-label"><span style="color:red">*</span>品牌</label>
        <div class="layui-input-inline">
            <input type="text" id="PinPai" required placeholder="请输入品牌" class="layui-input" />
        </div>
        <div class="layui-inline">
            <label class="layui-form-label"><span style="color:red">*</span>经营范围</label>
            <div class="layui-input-inline">
                <input type="text" id="FanWei" required placeholder="请输入经营范围" class="layui-input" />
            </div>
        </div>
    </div>
    <h2>联系信息</h2>
    <div class="layui-inline">
        <div class="layui-inline">
            <label class="layui-form-label"><span style="color:red">*</span>联系人</label>
            <div class="layui-input-inline">
                <input type="text" id="LianXiRen" required placeholder="请输入联系人" class="layui-input" />
            </div>
            <label class="layui-form-label">职业</label>
            <div class="layui-input-inline">
                <input type="text" id="ZhiYe" placeholder="请输入职业" class="layui-input" />
            </div>
            <label class="layui-form-label"><span style="color:red">*</span>手机</label>
            <div class="layui-input-inline">
                <input type="text" id="Phone" required placeholder="请输入手机" class="layui-input" />
            </div>
        </div>
        <div class="layui-inline">
            <label class="layui-form-label">固定电话</label>
            <div class="layui-input-inline">
                <input type="text" id="DianHua" placeholder="请输入固定电话" class="layui-input" />
            </div>
            <label class="layui-form-label">传真</label>
            <div class="layui-input-inline">
                <input type="text" id="ChuanZhen" placeholder="请输入传真" class="layui-input" />
            </div>
            <label class="layui-form-label">邮件</label>
            <div class="layui-input-inline">
                <input type="text" id="Email" placeholder="请输入邮件" class="layui-input" />
            </div>
        </div>
        <div class="layui-inline">
            <label class="layui-form-label">QQ</label>
            <div class="layui-input-inline">
                <input type="text" id="QQ" placeholder="请输入QQ" class="layui-input" />
            </div>
            <label class="layui-form-label">微信</label>
            <div class="layui-input-inline">
                <input type="text" id="WeiXin" placeholder="请输入微信" class="layui-input" />
            </div>
            <label class="layui-form-label"><span style="color:red">*</span>地址</label>
            <div class="layui-input-inline">
                <input type="text" id="DiZhi" required placeholder="请输入地址" class="layui-input" />
            </div>
        </div>
        <div class="layui-inline">
            <label class="layui-form-label">网址</label>
            <div class="layui-input-inline">
                <input type="text" id="Url" placeholder="请输入网址" class="layui-input" />
            </div>
        </div>
    </div>
</div>
<input type="button" id="Back" value="返回" style="background-color:gray" class="layui-btn layui-btn-normal" />
<input type="button" id="Save" value="修改" style="background-color:cornflowerblue" class="layui-btn layui-btn-normal" />

<script>
    //页面初始化
    $(function () {
        show();
    })
    //显示
    function show() {
        $.ajax({
            url: "http://localhost:52645/api/Supplier/ShowSup?id=" + $("#id").val(),
            type: "get",
            dataType: "json",
            success: function (d) {
                //反填数据
                $("#lid").val(d.lxrId); $("#Name").val(d.yJfzr);
                $("#BianHao").val(d.gid); $("#LaiYuan").val(d.gLaiYuan);
                $("#JianCheng").val(d.gDesc); $("#DanWei").val(d.dwName);
                $("#PinPai").val(d.pinPai); $("#FanWei").val(d.jyRange);
                $("#LianXiRen").val(d.lxrName); $("#ZhiYe").val(d.lJob);
                $("#Phone").val(d.phone); $("#DianHua").val(d.gDphone);
                $("#ChuanZhen").val(d.chuanZhen); $("#Email").val(d.email);
                $("#QQ").val(d.qq); $("#WeiXin").val(d.weiXin);
                $("#DiZhi").val(d.addresss); $("#Url").val(d.url);
            }
        })
    }

    //修改
    $("#Save").click(function () {
        //获取供应商数据
        var obj = {
            "GysId": $("#id").val().toString(),
            "GID": $("#BianHao").val().toString(),
            "GLaiYuan": $("#LaiYuan").val().toString(),
            "YJfzr": $("#Name").val().toString(),
            "DwName": $("#DanWei").val().toString(),
            "PinPai": $("#PinPai").val().toString(),
            "JYRange": $("#FanWei").val().toString(),
            "GDesc": $("#JianCheng").val().toString()
        };
        //获取联系人数据
        var obj1 = {
            "LxrId": $("#lid").val().toString(),
            "LxrName": $("#LianXiRen").val().toString(),
            "LJob": $("#ZhiYe").val().toString(),
            "Phone": $("#Phone").val().toString(),
            "Email": $("#Email").val().toString(),
            "GDphone": $("#DianHua").val().toString(),
            "ChuanZhen": $("#ChuanZhen").val().toString(),
            "QQ": $("#QQ").val().toString(),
            "WeiXin": $("#WeiXin").val().toString(),
            "Addresss": $("#DiZhi").val().toString(),
            "Url": $("#Url").val().toString()
        };
        //修改
        $.ajax({
            url: "http://localhost:52645/api/Supplier/EditSup",
            type: "post",
            dataType: "text",
            data: { supplier: obj, contacts: obj1 },
            accepts: "application/x-www-form-urlencoded",
            contentType: "application/x-www-form-urlencoded",
            success: function (d) {
                //判断
                if (d > 0) {
                    alert("修改成功!");
                    window.location.href = "Index";
                }
                else {
                    alert("修改失败!");
                }
            }
        })
    })

    //取消
    $("#Back").click(function () {
        window.location.href = "Index";
    })
</script>

